<html>
<head>
  <link href='style.css' rel='stylesheet' />
</head>
<body>
  <style  type="text/css">
    /**
     * markers
     */
    .djs-visual {
        marker-end: url(#sequenceflow-end-marker);
    }
  </style>

  <script src='../common.js'></script>
  <script src='../diagram.js'></script>
  <script>
    var Diagram = require('diagram');
    var diagram = new Diagram({ plugins: [
                                        'selectionUI',
                                        'dragUI',
                                        'standardPalette' ],
                                menu: [
                                  {
                                    id:   'main-menu',
                                    type: 'standardPalette',
                                    align: 'vertical',
                                    draggable: 'false',
                                    items: [
                                      {
                                        id: 'undo',
                                        icon: 'undo.svg',
                                        text: 'Undo last action'
                                      },
                                      {
                                        id: 'addShape',
                                        icon: 'add.svg',
                                        text: 'Add rect'
                                      }
                                    ]
                                  }
                                ]
    });


    diagram.inject([ 'events', 'canvas', 'commandStack', function(events, canvas, commandStack) {

      events.on('connection.added', function(event) {
        console.log('connection added', event);
      });

      events.on('shape.added', function(event) {
        console.log('shape added', event);
      });

      var s1 = {x: 10, y: 20, width: 100, height: 80 };
      var s2 = {x: 80, y: 10, width: 300, height: 140 };
      var s3 = {x: 100, y: 20, width: 100, height: 80, parent: s2 };
      var s4 = {x: 300, y: 300, width: 100, height: 80 };

     /* canvas
        .addShape(s1)
        .addShape(s2)
        .addShape(s3)
        .addShape(s4);*/
        commandStack.execute('addShape', s1);
        commandStack.execute('addShape', s2);
        commandStack.execute('addShape', s3);
        commandStack.execute('addShape', s4);

      canvas.addConnection({ waypoints: [ { x: 25, y: 25 }, {x: 115, y: 115} ]});
      canvas.addConnection({ waypoints: [ { x: 150, y: 150 }, { x: 200, y: 150 }, { x: 200, y: 200 }, { x: 300, y: 200} ]});
      canvas.addConnection({ waypoints: [ { x: 300, y: 300 }, { x: 100, y: 400 }, { x: 400, y: 100 }, { x: 500, y: 100 } ]});
    }]);
  </script>
</body>